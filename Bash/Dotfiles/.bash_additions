#!/bin/bash

export PATH="$HOME/bin:$PATH"

source ~/.virtualenvs/MainEnv/bin/activate

if [ -f "$HOME/.bashrc" ]; then
	alias r="source $HOME/.bashrc"
elif [ -f "$HOME/.bash_profile" ]; then
	alias r="source $HOME/.bash_profile"
fi

mkcd() {
	if [[ $# != 1 ]]; then
		echo "Usage: mkcd DIR"
	else
		mkdir -p -- "$1" && cd -P -- "$1"
	fi
}

border() {
	if [[ $# > 0 ]]; then
		b="#"
		lines=("$@")
		widest="0"
		for l in "${lines[@]}"; do
			if [[ ${#l} > $widest ]]; then widest="${#l}"; fi
		done
		full_widest="$((widest+4))"
		echo $(printf -- "$b%.0s" $(seq 1 $full_widest))
		for l in "${lines[@]}"; do
		width="${#l}"
		if [[ $width != $widest ]]; then
			echo "$b $l`printf ' %.0s' $(seq 1 $((widest-width)))` $b"
		else
			echo "$b $l $b"
		fi
		done
		echo $(printf -- "$b%.0s" $(seq 1 $full_widest))
	else
		echo "Usage: border STRING_ARRAY"
	fi
}

bo() {
	# Build-Only
	if [[ $# != 1 ]]; then
		echo "Usage: bo FILE"
	else
		g++ "$1" -o "${1%.cpp}"
	fi
}

bar() {
	# Build-And-Run
	if [[ $# != 1 ]]; then
		echo "Usage: bar FILE"
	else
		bo "$1"
		"./${1%.cpp}"
	fi
}

brr() {
	# Build-Run-Remove
	if [[ $# != 1 ]]; then
		echo "Usage: qmygpp FILE"
	else
		bar "$1"
		rm "./${1%.cpp}"
	fi
}

if [[ $(uname) == Darwin ]]; then
	close() {
		n=$(who | grep ttys -c)
		if [[ $n == 1 ]]; then
			osascript -e 'quit app "Terminal"'
		elif [[ $n > 1 ]]; then
			exit
		fi
	}

	rm() {
		args=("$@")
		nonflags=()
		for arg in "${args[@]}"; do
			if [[ $arg != -* ]]; then
				nonflags+=("$arg")
			fi
		done

		if [[ ${#nonflags[@]} > 0 ]]; then
			mv "${nonflags[@]}" "$HOME/.Trash"
		fi
	}
fi
